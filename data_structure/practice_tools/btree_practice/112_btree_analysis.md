# 112年公務人員特種考試關務人員 - B-Tree (2-3 Tree) 考題解析

## 題目
給予一串資料 `60, 70, 50, 10, 20, 80, 95, 90`，依序畫出產生 **2-3 樹 (Order 3 B-Tree)** 的過程，之後依序畫出刪除 `50`、`20` 與 `80` 的 2-3 樹。

---

## 第一部分：建立 2-3 樹 (Insertion)

**規則**：
*   **2-3 樹** 即為 Order 3 的 B-Tree。
*   每個節點最多 2 個鍵值 (Key)，3 個子節點。
*   插入時若節點滿 (3 個鍵值)，則中間值往上分裂。

### 1. 插入 60, 70
```
[60, 70]
```

### 2. 插入 50
`[50, 60, 70]` -> 分裂，**60** 往上。
```
    [60]
   /    \
[50]    [70]
```

### 3. 插入 10
插入左子樹 `[50]` -> `[10, 50]`
```
    [60]
   /    \
[10, 50] [70]
```

### 4. 插入 20
插入左子樹 `[10, 50]` -> `[10, 20, 50]` -> 分裂，**20** 往上。
根節點 `[60]` 變成 `[20, 60]`。
```
     [20, 60]
    /    |    \
 [10]  [50]  [70]
```

### 5. 插入 80
插入右子樹 `[70]` -> `[70, 80]`
```
     [20, 60]
    /    |    \
 [10]  [50]  [70, 80]
```

### 6. 插入 95
插入右子樹 `[70, 80]` -> `[70, 80, 95]` -> 分裂，**80** 往上。
根節點 `[20, 60]` 變成 `[20, 60, 80]` (3 個鍵值，溢位) -> 再次分裂，**60** 往上。
```
       [60]
      /    \
   [20]    [80]
  /   \    /   \
[10] [50] [70] [95]
```

### 7. 插入 90
插入右子樹的右子樹 `[95]` -> `[90, 95]`
```
       [60]
      /    \
   [20]    [80]
  /   \    /   \
[10] [50] [70] [90, 95]
```
**(這是插入完成後的最終狀態)**

---

## 第二部分：刪除 (Deletion)

**規則**：
*   **刪除葉子節點**：直接刪除。若剩 0 個鍵值 (Underflow)，需處理。
*   **Underflow 處理**：
    1.  **跟兄弟借 (Borrow/Rotate)**：兄弟有 2 個鍵值時。
    2.  **跟兄弟合併 (Merge)**：兄弟只有 1 個鍵值時，將父節點的分隔鍵值拉下來一起合併。

### 1. 刪除 50
`50` 在葉子節點 `[50]`。
刪除後該節點變空 `[]` (Underflow)。
*   **檢查兄弟**：左兄弟 `[10]` (1 個鍵值)，右兄弟 `[70]` (1 個鍵值)。無法借位。
*   **合併**：選擇與左兄弟 `[10]` 合併。
*   **動作**：將父節點 `[20]` 中的分隔鍵值 **20** 拉下來，與 `[10]` 合併。
*   **結果**：左子樹變成 `[10, 20]`。父節點 `[20]` 變空 `[]` (Underflow)。

**處理父節點 `[]` 的 Underflow**：
*   父節點是 `[]` (原 `[20]` 的位置)。
*   它的兄弟是 `[80]` (1 個鍵值)。無法借位。
*   **合併**：將根節點 `[60]` 拉下來，與兄弟 `[80]` 合併。
*   **結果**：根節點消失，樹高降低。新的根節點為 `[60, 80]`。
*   **子節點結構**：`[10, 20]` (原左), `[70]` (原中), `[90, 95]` (原右)。

**刪除 50 後的樹**：
```
      [60, 80]
     /    |    \
[10, 20] [70] [90, 95]
```

### 2. 刪除 20
`20` 在葉子節點 `[10, 20]`。
直接刪除 `20`，剩 `[10]`。沒有 Underflow。

**刪除 20 後的樹**：
```
      [60, 80]
     /    |    \
  [10]  [70] [90, 95]
```

### 3. 刪除 80
`80` 在根節點 `[60, 80]` (非葉子)。
*   **取代**：用其**後繼者 (Successor)** 取代。`80` 的後繼者是右子樹 `[90, 95]` 中的最小植 **90**。
*   **動作**：將 `90` 移到 `80` 的位置。根節點變 `[60, 90]`。
*   **刪除後繼者**：從葉子 `[90, 95]` 中刪除 `90`。剩 `[95]`。

**刪除 80 後的樹**：
```
      [60, 90]
     /    |    \
  [10]  [70]  [95]
```
**(這是最終結果)**
