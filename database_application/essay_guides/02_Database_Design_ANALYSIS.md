# 02 Database Design å®Œæ•´é¡Œç›®è§£æ - ç”³è«–é¡Œç­”é¡Œæ¡†æ¶

é€™ä»½æ–‡ä»¶é‡å°**02 Database Design**ç›¸é—œé¡Œç›®æä¾›è©³ç›¡çš„ç”³è«–é¡Œç­”é¡Œæ¶æ§‹ã€‚

---

## ğŸ“Š é¡Œç›®ç¸½è¦½

æ ¹æ“šåˆ†æï¼Œåœ¨æ­·å¹´è³‡æ–™åº«æ‡‰ç”¨è€ƒé¡Œä¸­ï¼š

### é¡Œç›®çµ±è¨ˆ

| çµ±è¨ˆé …ç›® | æ•¸é‡ |
|---------|------|
| **åˆ†æè€ƒå·ç¸½æ•¸** | **74 ä»½** |
| **02 Database Designç›¸é—œé¡Œç›®** | **93 é¡Œ** |
| **114å¹´é¡Œç›®** | 9 é¡Œ |
| **é‡è¦æ€§æ’å** | **No. 2 (å¿…è€ƒé¡Œå‹)** |

### é¡Œå‹åˆ†é¡

| é¡Œå‹ | å æ¯” | ä»£è¡¨é¡Œç›® | é›£åº¦ |
|------|------|---------|------|
| **ER Modelè¨­è¨ˆ** | 40% | å¯¦é«”ã€å±¬æ€§ã€é—œè¯ç¹ªè£½ | â­â­â­ |
| **é—œè¯ç¶±è¦è½‰æ›** | 30% | ERè½‰Relational Schema | â­â­â­ |
| **EERé€²éšè¨­è¨ˆ** | 20% | ç¹¼æ‰¿ã€é¡åˆ¥ã€èšåˆ | â­â­â­â­ |
| **è¨­è¨ˆç†è«–** | 10% | æ­£è¦åŒ–èˆ‡è¨­è¨ˆåŸå‰‡ | â­â­â­â­ |

**é›£åº¦æ˜Ÿç´šèªªæ˜**:
- â­â­â­ = åŸºç¤å¿…è€ƒ
- â­â­â­â­ = é€²éšé‡è¦
- â­â­â­â­â­ = æ–°èˆˆç†±é–€ (è¿‘ä¸‰å¹´å¤§é‡å‡ºç¾)

---

## ğŸ¯ ç”³è«–é¡Œç­”é¡Œé»ƒé‡‘æ¶æ§‹

è³‡æ–™åº«è¨­è¨ˆé¡Œé€šå¸¸éœ€è¦ã€Œç•«åœ–ã€é…åˆã€Œæ–‡å­—èªªæ˜ã€ã€‚

### 1. ER/EER ç•«åœ–é¡Œæ¶æ§‹

> **ä¸€ã€å¯¦é«”èˆ‡å±¬æ€§å®šç¾©**
> (åˆ—å‡ºä¸»è¦ Entity åŠå…¶ Attributeï¼Œæ¨™ç¤º Primary Key)
>
> **äºŒã€é—œè¯èˆ‡åŸºæ•¸èªªæ˜**
> (åˆ—å‡º Relationshipï¼Œèªªæ˜ 1:1, 1:N, M:N åŠåƒèˆ‡åº¦)
>
> **ä¸‰ã€ER/EER åœ–**
> (æ¸…æ™°ç¹ªè£½åœ–å½¢ï¼Œä½¿ç”¨æ¨™æº–ç¬¦è™Ÿ)
>
> **å››ã€è¨­è¨ˆå‡è¨­ (Assumptions)**
> (è‹¥é¡Œç›®èªæ„ä¸æ¸…ï¼Œå‹™å¿…å¯«å‡ºä½ çš„å‡è¨­)

### 2. Mapping è½‰ç½®é¡Œæ¶æ§‹

> **ä¸€ã€è½‰æ›åŸå‰‡èªªæ˜**
> (ç°¡è¿°è½‰æ›è¦å‰‡ï¼Œä¾‹å¦‚ "M:N é—œè¯éœ€è½‰æ›ç‚ºç¨ç«‹è¡¨æ ¼")
>
> **äºŒã€é—œè¯ç¶±è¦ (Relational Schema)**
> (åˆ—å‡º Schemaï¼Œæ¸…æ¥šæ¨™ç¤º PK èˆ‡ FK)
>
> **ä¸‰ã€å®Œæ•´æ€§é™åˆ¶**
> (èªªæ˜ Entity Integrity èˆ‡ Referential Integrity)

---



---

## ğŸ“š ã€æ ¸å¿ƒçŸ¥è­˜ã€‘å®Œå…¨è§£æ



---

## ğŸ“ å¯¦æˆ°è§£æï¼šç²¾é¸é¡Œå‹è©³è§£

### ã€é¡Œå‹ä¸€ã€‘åŸºç¤ ER Model è¨­è¨ˆ

#### ğŸ“Œ åŸé¡Œï¼š105å¹´åœ°æ–¹ç‰¹è€ƒä¸‰ç­‰ï¼ˆç¾ç¾è—¥å¦åº—ï¼‰

> **é¡Œç›®**ï¼š
> ç¾ç¾è—¥å¦åº—å§”è¨—è»Ÿé«”å…¬å¸å»ºç½®ç®¡ç†è³‡è¨Šç³»çµ±ï¼Œè³‡æ–™åº«çš„è³‡æ–™éœ€æ±‚å¦‚ä¸‹ï¼š
>
> - **é¡§å®¢**ï¼šé¡§å®¢ç·¨è™Ÿ(PK)ã€å§“åã€ä½å€ã€æ‰‹æ©Ÿã€‚æ¯æ¬¡å¯è³¼è²·æ•¸ä»¶å•†å“ã€‚
> - **è—¥å¦å•†å“**ï¼šå•†å“ç·¨è™Ÿ(PK)ã€åç¨±ã€ç¨®é¡ã€å–®åƒ¹ã€å» å•†ç·¨è™Ÿã€‚
> - **ä¾›æ‡‰å•†**ï¼šå» å•†ç·¨è™Ÿ(PK)ã€åç¨±ã€ä½å€ã€é›»è©±ã€‚æ¯æ¬¡å¯ä¾›æ‡‰æ•¸ä»¶å•†å“ã€‚
> - **è¨‚å–®**ï¼šè¨‚å–®ç·¨è™Ÿ(PK)ã€æ—¥æœŸã€æ•¸é‡ã€å‚™è¨»ã€é¡§å®¢ç·¨è™Ÿã€å•†å“ç·¨è™Ÿã€‚
>
> â‘´ è«‹ç¹ªè£½è³‡æ–™è¡¨é—œè¯åœ–ä»¥å‘ˆç¾è³‡æ–™çš„æ¦‚å¿µæ¨¡å¼ã€‚ï¼ˆ15 åˆ†ï¼‰
> â‘µ è«‹åˆ—å‡ºæ¯å€‹é—œè¯è³‡æ–™è¡¨çš„ç¶±è¦ï¼ˆTable Schemaï¼‰ã€‚ï¼ˆ10 åˆ†ï¼‰

#### ğŸ’¡ è§£æèˆ‡æ“¬ç­”

**â‘´ å¯¦é«”é—œä¿‚åœ– (ER Diagram)**

*(è€ƒè©¦æ™‚è«‹ç•«å‡ºåœ–å½¢ï¼Œä»¥ä¸‹ç‚ºæ–‡å­—æè¿°)*

1. **Entities (å¯¦é«”)**:
    - `Customer` (<u>CustomerID</u>, Name, Address, Phone)
    - `Product` (<u>ProductID</u>, Name, Type, Price)
    - `Supplier` (<u>SupplierID</u>, Name, Address, Phone)
    - `Order` (<u>OrderID</u>, Date, Note, Quantity) â€” *æ³¨æ„ï¼šé¡Œç›®å°‡è¨‚å–®è¦–ç‚ºå¯¦é«”*

2. **Relationships (é—œè¯)**:
    - `Purchase` (Customer --< Order): 1:N
        - ä¸€å€‹é¡§å®¢å¯ä»¥æœ‰å¤šå¼µè¨‚å–®
        - ä¸€å¼µè¨‚å–®å±¬æ–¼ä¸€å€‹é¡§å®¢
    - `Contain` (Order >-- Product): N:1 *ï¼ˆä¾é¡Œç›®æ•˜è¿°"è¨‚å–®...å•†å“ç·¨è™Ÿ"ï¼Œæ¯å¼µè¨‚å–®ä¼¼ä¹åªå°æ‡‰ä¸€å€‹å•†å“ï¼Œè‹¥ç‚ºä¸€èˆ¬è³¼ç‰©è»Šå‰‡æ‡‰ç‚º M:Nï¼Œæ­¤è™•éœ€ä¾é¡Œç›®"è¨‚å–®...å•†å“ç·¨è™Ÿ"ä¹‹å–®æ•¸æ¬„ä½åˆ¤æ–·ç‚º N:1ï¼Œæˆ–å‡è¨­è¨‚å–®ç‚ºè¨‚å–®æ˜ç´°ï¼‰*
        - **é—œéµå‡è¨­**ï¼šä¾é¡Œç›®æ¬„ä½è¨­è¨ˆï¼Œä¸€å¼µã€Œè¨‚å–®ã€åŒ…å«ä¸€å€‹ã€Œå•†å“ç·¨è™Ÿã€ï¼Œæ•…å‡è¨­æ­¤è™• Order å¯¦ç‚º OrderItem æˆ–å–®ä¸€å•†å“è¨‚å–®ã€‚
    - `Supply` (Supplier --< Product): 1:N
        - ä¸€å€‹ä¾›æ‡‰å•†ä¾›æ‡‰å¤šç¨®å•†å“
        - ä¸€å€‹å•†å“ç”±ä¸€å€‹ä¾›æ‡‰å•†ä¾›æ‡‰ï¼ˆä¾é¡Œç›®"å•†å“...å» å•†ç·¨è™Ÿ"ï¼‰

**â‘µ é—œè¯ç¶±è¦ (Relational Schema)**

- **Customer** (<u>CustomerID</u>, Name, Address, Phone)
- **Supplier** (<u>SupplierID</u>, Name, Address, Phone)
- **Product** (<u>ProductID</u>, Name, Type, Price, *SupplierID*)
  - FK: SupplierID references Supplier(SupplierID)
- **Order** (<u>OrderID</u>, Date, Quantity, Note, *CustomerID*, *ProductID*)
  - FK: CustomerID references Customer(CustomerID)
  - FK: ProductID references Product(ProductID)

---

### ã€é¡Œå‹äºŒã€‘é€²éš EER Model (ç‰©ä»¶å°å‘ + BCNF)

#### ğŸ“Œ åŸé¡Œï¼š114å¹´ä¸€èˆ¬è­¦å¯Ÿç‰¹è€ƒä¸‰ç­‰ï¼ˆå—ç†æ¡ˆä»¶ç®¡ç†ï¼‰

> **é¡Œç›®**ï¼š
> è«‹è¨­è¨ˆç¬¦åˆ **BCNF** ä¸”è€ƒé‡ **OO (ç‰©ä»¶å°å‘)** çš„ **Enhanced-ER (EER)** data modelã€‚
> éœ€æ±‚åŒ…å«ï¼šå—ç†å–®ä½ã€è­¦æ”¿äººå“¡ã€å—ç†æ¡ˆä»¶ã€‚
>
> - å–®ä½åŒ…å«ç¸£å¸‚ã€åˆ†å±€ã€æ´¾å‡ºæ‰€ã€‚
> - è­¦æ”¿äººå“¡åŒä¸€æ™‚é–“åªèƒ½éš¸å±¬ä¸€å€‹å–®ä½ã€‚
> - æ¡ˆä»¶ç”±å–®ä½ã€æ—¥æœŸã€æµæ°´è™Ÿçµ„æˆå”¯ä¸€æ€§ã€‚
> - éœ€è¨˜éŒ„å ±æ¡ˆäººã€å—ç†äººã€å–®ä½ä¸»ç®¡ã€‚
> - ç‰¹æ®Šæ¡ˆä»¶ï¼šè»Šè¼›å”å°‹ï¼ˆéœ€è¨˜éŒ„è»Šç‰Œã€è£½é€ å•†ç­‰ï¼‰ã€‚

#### ğŸ’¡ è§£æèˆ‡æ“¬ç­”

é€™é¡Œè€ƒé©— **Supertype/Subtype (ç¹¼æ‰¿)** çš„æ¦‚å¿µã€‚

**ä¸€ã€å¯¦é«”è¨­è¨ˆ (Entities)**

1. **Person (Supertype)**
    - Attributes: ID(PK), Name, Phone, Address
    - **Subtypes**:
        - `PoliceOfficer` (Rank, DateHired)
        - `Civilian` (Reporter)
2. **Unit (å–®ä½)**
    - Attributes: <u>UnitID</u>, City, Precinct(åˆ†å±€), Station(æ´¾å‡ºæ‰€)
3. **Case (æ¡ˆä»¶ - Supertype)**
    - Attributes: <u>CaseNo</u> (Composite: UnitID + Date + Seq), Time, Location, Content
    - **Subtypes**:
        - `GeneralCase`
        - `VehicleSearchCase` (LicensePlate, Manufacturer, OwnerID)

**äºŒã€é—œè¯è¨­è¨ˆ (Relationships)**

1. **BelongTo** (PoliceOfficer -- Unit): N:1 (è­¦å“¡éš¸å±¬å–®ä½)
2. **Manage** (PoliceOfficer -- Unit): 1:1 (ä¸»ç®¡ç®¡ç†å–®ä½ï¼Œéœ€è¨˜éŒ„æœŸé–“)
3. **Handle** (PoliceOfficer -- Case): 1:N (è­¦å“¡å—ç†æ¡ˆä»¶)
4. **Report** (Civilian -- Case): 1:N (æ°‘çœ¾å ±æ¡ˆ)
5. **OccurAt** (Case -- Unit): N:1 (æ¡ˆä»¶ç™¼ç”Ÿæ–¼æŸè½„å€)

**ä¸‰ã€EER ç‰¹é»èªªæ˜**

- **ç¹¼æ‰¿ (Inheritance)**: ä½¿ç”¨ `IS-A` é—œä¿‚ã€‚
  - Case (Supertype) åˆ†å‡º VehicleSearchCase (Subtype)ã€‚
  - VehicleSearchCase ç¹¼æ‰¿ Case æ‰€æœ‰å±¬æ€§ï¼Œä¸¦å¢åŠ  LicensePlate ç­‰ç‰¹æœ‰å±¬æ€§ã€‚
- **BCNF è€ƒé‡**:
  - ç¢ºä¿æ‰€æœ‰ç›¸ä¾æ€§éƒ½æ˜¯ç”± Key æ±ºå®šçš„ã€‚
  - ä¾‹å¦‚ã€Œå–®ä½åç¨±ã€è‹¥åŒ…å«ç¸£å¸‚ã€åˆ†å±€ï¼Œæ‡‰æ‹†è§£æˆ–æ­£è¦åŒ–ï¼Œé¿å…é‡è¤‡ã€‚

---

### ã€é¡Œå‹ä¸‰ã€‘Mapping è½‰æ›è¦å‰‡

#### ğŸ“Œ åŸé¡Œï¼š104å¹´èª¿æŸ¥å±€ä¸‰ç­‰ï¼ˆBorrower é—œä¿‚è½‰æ›ï¼‰

> **é¡Œç›®**ï¼š
> `borrower` ä»£è¡¨ `customer` èˆ‡ `loan` ä¹‹é–“çš„é—œä¿‚ã€‚
> è«‹åˆ†åˆ¥å°± **å¤šå°å¤š (M:N)**ã€**å¤šå°ä¸€ (N:1)**ã€**ä¸€å°ä¸€ (1:1)** ä¸‰ç¨®æƒ…å½¢ï¼Œ
> æ±ºå®šå¦‚ä½•è½‰æˆé—œè¯å¼ç¶±ç›®ä¸¦æ¨™ç¤ºä¸»éµã€‚

#### ğŸ’¡ è§£æèˆ‡æ“¬ç­”

é€™æ˜¯è§€å¿µé¡Œï¼Œå¿…é ˆæ¸…æ¥šä¸åŒåŸºæ•¸ (Cardinality) çš„è½‰æ›è¦å‰‡ã€‚

**1. å¤šå°å¤š (Many-to-Many, M:N)**

- **è¦å‰‡**ï¼šå¿…é ˆå°‡é—œä¿‚ `borrower` è½‰æ›ç‚ºä¸€å€‹**ç¨ç«‹çš„è¡¨æ ¼**ã€‚
- **Schema**:
  - Customer(<u>customer-id</u>, ...)
  - Loan(<u>loan-number</u>, ...)
  - Borrower(<u>customer-id</u>, <u>loan-number</u>)
- **PK**: å…©é‚Šä¸»éµçš„çµ„åˆ `{customer-id, loan-number}`ã€‚

**2. å¤šå°ä¸€ (Many-to-One, N:1)**
*(å‡è¨­å¤šå€‹ Loan å±¬æ–¼ä¸€å€‹ Customer)*

- **è¦å‰‡**ï¼šå°‡ "1" é‚£ä¸€æ–¹çš„ä¸»éµï¼ŒåŠ å…¥åˆ° "N" é‚£ä¸€æ–¹ä½œç‚ºå¤–ä¾†éµã€‚
- **Schema**:
  - Customer(<u>customer-id</u>, ...)
  - Loan(<u>loan-number</u>, ..., *customer-id*)
- **PK**: Loan çš„ä¸»éµ `{loan-number}` å³å¯ã€‚`customer-id` æ˜¯ FKã€‚

**3. ä¸€å°ä¸€ (One-to-One, 1:1)**

- **è¦å‰‡**ï¼šæœ‰å…©ç¨®åšæ³•ã€‚
    1. **åˆä½µæ³•**ï¼šè‹¥åƒèˆ‡åº¦ç‚ºå®Œå…¨åƒèˆ‡ (Total Participation)ï¼Œå¯å°‡å…©è¡¨åˆä½µã€‚
    2. **å¤–ä¾†éµæ³•**ï¼šå°‡ä»»ä¸€æ–¹çš„ä¸»éµåŠ å…¥å¦ä¸€æ–¹ä½œç‚º FK (é€šå¸¸é¸å®Œå…¨åƒèˆ‡çš„é‚£ä¸€æ–¹åŠ å…¥ FK)ã€‚
- **Schema (å¤–ä¾†éµæ³•)**:
  - Customer(<u>customer-id</u>, ...)
  - Loan(<u>loan-number</u>, ..., *customer-id*)
- **PK**: `{loan-number}`ã€‚ä¸” `customer-id` éœ€è¨­ç‚º UNIQUE (å› ç‚ºæ˜¯ 1:1)ã€‚

---

### ã€é¡Œå‹å››ã€‘è¨­è¨ˆç†è«–

#### ğŸ“Œ åŸé¡Œï¼š114å¹´é«˜è€ƒä¸‰ç´šï¼ˆEER è¦ç´ ï¼‰

> **é¡Œç›®**ï¼š
> èªªæ˜ EER æ¨¡å‹çš„å››å€‹æ§‹æˆè¦ç´ ï¼Œä¸¦èˆ‰ä¾‹ï¼š
> â‘´ Entity, â‘µ Attribute, â‘¶ Relationship, â‘· Supertype/Subtype

#### ğŸ’¡ è§£æèˆ‡æ“¬ç­”

**â‘´ Entity (å¯¦é«”)**

- **å®šç¾©**ï¼šçœŸå¯¦ä¸–ç•Œä¸­å¯å€åˆ¥çš„ç‰©ä»¶ã€‚
- **ä¾‹**ï¼š`å­¸ç”Ÿ`ã€`èª²ç¨‹`ã€‚

**â‘µ Attribute (å±¬æ€§)**

- **å®šç¾©**ï¼šæè¿°å¯¦é«”ç‰¹å¾µçš„è³‡æ–™å–®å…ƒã€‚
- **ä¾‹**ï¼šå­¸ç”Ÿçš„`å­¸è™Ÿ`ã€`å§“å`ã€‚

**â‘¶ Relationship (é—œè¯)**

- **å®šç¾©**ï¼šå¯¦é«”ä¹‹é–“çš„é—œè¯æ€§ã€‚
- **ä¾‹**ï¼šå­¸ç”Ÿ `ä¿®èª²` èª²ç¨‹ (M:N é—œè¯)ã€‚

**â‘· Supertype/Subtype (è¶…é¡åˆ¥/å­é¡åˆ¥)**

- **å®šç¾©**ï¼šå¯¦é«”é–“çš„ç¹¼æ‰¿é—œä¿‚ï¼Œå­é¡åˆ¥ç¹¼æ‰¿è¶…é¡åˆ¥çš„å±¬æ€§èˆ‡é—œè¯ã€‚
- **ä¾‹**ï¼š
  - Supertype: `å“¡å·¥` (å±¬æ€§ï¼šå“¡å·¥è™Ÿã€å§“å)
  - Subtype: `å·¥ç¨‹å¸«` (ç‰¹æœ‰å±¬æ€§ï¼šç¨‹å¼èªè¨€)ã€`ç¶“ç†` (ç‰¹æœ‰å±¬æ€§ï¼šè·ç­‰)

---



---

## ğŸ“– æ­·å±†è€ƒé¡Œå½™æ•´é€£çµ

è«‹åƒé–±åŒç›®éŒ„ä¸‹çš„ `02_Database_Design.md` æª”æ¡ˆä»¥æŸ¥çœ‹å®Œæ•´æ­·å±†è€ƒé¡Œã€‚
