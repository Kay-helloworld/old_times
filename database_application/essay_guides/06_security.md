# 06_security.md - 資訊安全申論題完全解析

## 📊 題目總覽與統計

**資訊安全 (Information Security)** 在資料庫考題中佔有一席之地，主要聚焦於「資料庫層級」的安全機制，如存取控制、檢視表 (View) 的應用、以及最經典的 SQL Injection 攻擊與防禦。

- **總題數**：約 17 題（佔比約 10%）
- **出題頻率**：⭐⭐⭐（穩定出現）
- **難度**：⭐⭐⭐（觀念明確，容易拿分）
- **主要題型**：
    1. **攻擊防禦**：SQL Injection (資料隱碼攻擊) 原理與防範。
    2. **存取控制**：DAC, MAC, RBAC 比較。
    3. **資料庫機制**：View (視圖) 的安全用途、Trigger (觸發器) 的稽核用途。
    4. **完整性與稽核**：外來鍵約束 (CASCADE/RESTRICT)、資料庫日誌 (Log) 種類。

---

## 🎯 申論題答題黃金架構

### 1. 攻擊防禦題型 (例如：SQL Injection)

> **一、攻擊原理**
> (說明駭客如何透過輸入惡意字串，改變 SQL 語法邏輯)
>
> **二、攻擊範例**
> (舉例：`' OR '1'='1` 繞過登入驗證)
>
> **三、防範措施**
> (列出 3 點：使用 Prepared Statement、輸入驗證、最小權限原則)

### 2. 機制說明題型 (例如：View 的安全用途)

> **一、定義**
> (簡述 View 是虛擬資料表)
>
> **二、安全機制**
> (說明如何透過 View 隱藏敏感欄位，僅開放必要資料給使用者)
>
> **三、優缺點**
> (優點：簡化查詢、安全性；缺點：效能開銷)

---

## 📝 實戰解析：精選題型詳解

### 【題型一】SQL Injection (資料隱碼攻擊)

#### 📌 原題：113年一般警察三等

> **題目**：
> 使用者輸入帳號 `acc` 和密碼 `pwd`。若輸入特定字串，雖未儲存於資料庫，卻可通過檢核進入會員區。
> 請問此攻擊名稱為何？解釋原因？並說明二種防制方法。

#### 💡 解析與擬答

**一、攻擊名稱**
**SQL Injection (資料隱碼攻擊)**。

**二、攻擊原因**
程式設計時，直接將使用者輸入的字串與 SQL 指令進行**字串串接 (String Concatenation)**，導致使用者輸入的惡意字元 (如單引號 `'`) 改變了原本 SQL 語句的邏輯結構。

- **範例**：
    原本程式：`SELECT * FROM member WHERE account = '` + `acc` + `' AND password = '` + `pwd` + `'`
    惡意輸入：`acc` 輸入 `' OR '1'='1`
    結果 SQL：`SELECT * FROM member WHERE account = '' OR '1'='1' AND ...`
    由於 `'1'='1'` 恆為真 (True)，導致 `WHERE` 子句條件永遠成立，成功繞過驗證。

**三、防制方法**

1. **使用參數化查詢 (Parameterized Query / Prepared Statement)**：
    這是最有效的方法。資料庫會將使用者輸入視為純粹的「參數值」，而非 SQL 指令的一部分，徹底阻斷惡意語法執行。
2. **輸入驗證 (Input Validation)**：
    檢查輸入資料是否符合預期格式 (如長度、型別)，並過濾特殊字元 (如單引號)。

---

### 【題型二】資料庫日誌 (Database Logs) 與稽核

#### 📌 原題：114年身心障礙三等

> **題目**：
> 說明 MySQL 常見日誌的用途：Transaction Log, Error Log, Query Log, Slow Query Log, Replication Log, Audit Log。

#### 💡 解析與擬答

這題考驗對資料庫維運與稽核的廣度認識。

| 日誌類型 | 用途說明 |
| :--- | :--- |
| **1. Transaction Log (交易日誌)** | 記錄交易的變更 (Redo/Undo)，用於系統崩潰後的**復原 (Recovery)**，確保 ACID 特性。 |
| **2. Error Log (錯誤日誌)** | 記錄資料庫啟動、停止及執行過程中的**嚴重錯誤訊息**，供管理員除錯。 |
| **3. General Query Log (查詢日誌)** | 記錄客戶端連線及**所有執行的 SQL 指令**，用於追蹤使用者行為。 |
| **4. Slow Query Log (慢查詢日誌)** | 記錄執行時間超過設定閾值的 SQL 指令，用於**效能調校**與優化。 |
| **5. Replication Log (複寫日誌)** | 即 Binary Log (Binlog)，記錄所有資料變更，用於主從式架構的**資料同步**。 |
| **6. Audit Log (稽核日誌)** | 記錄誰 (Who) 在何時 (When) 做了什麼 (What)，專用於**資安稽核**與合規性檢查。 |

---

### 【題型三】外來鍵約束與完整性 (Referential Integrity)

#### 📌 原題：114年身心障礙三等

> **題目**：
> 當主鍵 (PK) 紀錄被刪除時，外鍵 (FK) 有三種處理選項：CASCADE, SET NULL, RESTRICT。請說明差異。

#### 💡 解析與擬答

這是維護**參考完整性 (Referential Integrity)** 的關鍵機制。假設「部門表 (PK)」與「員工表 (FK)」有關聯。

**1. CASCADE (連鎖)**

- **行為**：當父表 (部門) 紀錄被刪除時，子表 (員工) 對應的紀錄也會**一併被自動刪除**。
- **影響**：資料清理最徹底，但風險最大，可能誤刪大量資料。

**2. SET NULL (設為空值)**

- **行為**：當父表紀錄被刪除時，子表對應的外鍵欄位會被**設為 NULL**。
- **影響**：保留子表紀錄，但該員工變成「無所屬部門」。(前提是 FK 欄位允許 NULL)。

**3. RESTRICT / NO ACTION (限制/不動作)**

- **行為**：當父表紀錄被刪除時，若子表仍有對應紀錄，則**拒絕刪除**父表紀錄並回傳錯誤。
- **影響**：保護機制最強，確保不會有「孤兒資料」產生。通常是預設值。

---

### 【題型四】View (視圖) 的安全用途

#### 📌 原題：113年一般警察三等

> **題目**：
> 闡述界視表 (VIEW) 的用途與優缺點。

#### 💡 解析與擬答

**一、用途 (安全性面向)**
View 是基於 SELECT 查詢所建立的虛擬表格。在資安上，它扮演**存取控制**的角色：

1. **隱藏敏感欄位**：例如員工資料表有 `Salary` 欄位，可建立一個不包含 `Salary` 的 View 開放給一般行政人員查詢，避免薪資外洩。
2. **列級安全 (Row-Level Security)**：透過 `WHERE` 子句 (例如 `WHERE DeptID = 'IT'`)，限制使用者只能看到自己部門的資料。

**二、優點**

1. **簡化查詢**：將複雜的 JOIN 封裝起來。
2. **邏輯獨立性**：底層資料表結構改變時，只需修改 View 定義，不影響上層應用程式。
3. **安全性**：提供細粒度的資料存取控制。

**三、缺點**

1. **效能開銷**：查詢 View 時需即時轉換為底層查詢，多一層轉換成本。
2. **更新限制**：並非所有 View 都能支援 INSERT/UPDATE (特別是包含聚合函數或 DISTINCT 時)。

---

## 📚 其他重要題型速覽

1. **存取控制模型 (Access Control Models)**
    - **DAC (自主式)**：檔案擁有者決定誰可以存取 (如 Linux 檔案權限)。靈活但安全風險高。
    - **MAC (強制式)**：系統根據安全標籤 (如：機密、絕密) 強制決定。軍方常用，最安全但最不便。
    - **RBAC (角色基礎)**：根據使用者的「角色」(如：經理、會計) 授權。企業最常用，管理效率高。

2. **加密技術 (Encryption)**
    - **對稱式 (Symmetric)**：加密解密用同一把金鑰 (如 AES)。速度快，但金鑰傳遞困難。
    - **非對稱式 (Asymmetric)**：公鑰加密、私鑰解密 (如 RSA)。安全性高，適合金鑰交換與數位簽章。

---

## ⚔️ 答題總策略

### ✅ 關鍵字得分技巧

- 寫到 **SQL Injection** 必提：**「參數化查詢 (Parameterized Query)」、「輸入驗證」**。
- 寫到 **FK Constraint** 必提：**「參考完整性」、「孤兒資料 (Orphan Data)」**。
- 寫到 **View** 必提：**「虛擬表格」、「隱藏敏感資料」、「邏輯獨立性」**。

### 🎨 實務連結

- 資安題型很重視「實務應用」。在回答防禦措施時，若能帶入 **OWASP Top 10** 或 **最小權限原則 (Least Privilege)** 等概念，會讓閱卷老師覺得你很有 sense。

---

## 📖 推薦練習題目

### ★★★ 必練 (基礎)

1. **113 一般警察三等** (SQL Injection)：攻擊原理與防禦。
2. **114 身心障礙三等** (FK Constraint)：CASCADE/SET NULL/RESTRICT 比較。

### ★★ 進階 (廣度)

1. **114 身心障礙三等** (Logs)：各種日誌用途。
2. **113 一般警察三等** (View)：View 的優缺點。

---

> **💡 媽媽的備忘錄**：
>
> - **SQL Injection** 就像是壞人在填寫名字時，偷偷寫了「把銀行金庫打開」，如果行員 (資料庫) 沒檢查就照做，錢就被偷走了！所以一定要用「參數化查詢」這個防護罩。
> - **View** 就像是給客人看的「菜單」，客人只能點菜單上有的菜，看不到廚房裡 (底層資料表) 的髒亂或是老闆的私房錢 (敏感資料)。
